# 现金流沙盘（重构版）游玩指南（玩家向）

本指南面向“玩家”，不涉及开发细节。规则口径以游戏内规则实现与提示为准。

---

## 0. 快速开始（本地运行，可选）

1) 安装依赖：`npm install`  
2) 启动：`npm run dev`  
3) 打开：`http://localhost:3000`

> 你也可以直接部署到 Vercel 后，通过线上地址游玩（玩法一致）。

---

## 1. 建局：创建玩家与对局设置

![建局界面标注](/player-guide/01-setup.png)

- `1` 语言切换：中/英文立即生效（用于多人同屏不同习惯时）。
- `2` 玩家信息：填写姓名、选择棋子颜色、职业与梦想版图。
- `3` 新增玩家：多人游戏时点这里添加第 2/3/4… 位玩家。
- `4` 开始游戏：至少 1 名玩家即可开始。
- `5` 对局设置：起始储蓄与卡组开关（小投资/大投资/优先股/骰子规则）。
- `6` 回放/导入：导入复盘 JSON，可逐步查看日志与报表变化。

---

## 2. 多人：添加第二位玩家（可选）

![多人建局标注](/player-guide/02-add-players.png)

- `1` 语言切换（同上）。
- `2` 玩家 1 配置区：设置姓名/职业/梦想/颜色。
- `3` 玩家 2 配置区：同玩家 1。
- `4` 智能玩家（LLM）：为该玩家开启“智能玩家”（需要在界面内提供模型与提示词/或配置 `OPENAI_API_KEY`）。
- `5` 开始游戏。
- `6` 对局设置：建议新手保持默认（均开启）。
- `7` 回放/导入：用于复盘或教学演示。

---

## 3. 进入棋盘：你会看到什么

![棋盘总览标注](/player-guide/03-board-overview.png)

- `1` 语言切换。
- `2` 棋盘区：显示你所在的“老鼠赛跑（内圈）”格子。落点类型会影响你能抽什么牌/要付什么钱。
- `3` 玩家概览：每个玩家的现金、被动收入、薪水与梦想。
- `4` 资产/负债报表：当前玩家的资产与负债明细（含“主动清算”提示）。
- `5` 行动区：核心按钮通常在这里出现（掷骰、结束回合、抽卡等）。
- `6` 抽卡按钮区：落点不同会启用不同按钮（例如机会格才能抽投资卡）。
- `7` 合资项目：发起合资并选择参与玩家。
- `8` 游戏日志：每一步都会记录，可导出 JSON 用于复盘。
- `9` 玩家借贷：玩家之间建立借贷关系（本金/利率/还款）。
- `10` 回放/导入：导入复盘 JSON 后可逐步查看。

---

## 4. 一个标准回合怎么走（掷骰 → 落点 → 处理）

![回合动作标注](/player-guide/04-roll-and-actions.png)

- `1` 语言切换。
- `2` 棋盘区：走到哪个格子由掷骰结果决定。
- `3` 玩家概览：看现金是否充足、被动收入是否增长。
- `4` 资产/负债报表：买入/卖出后会即时反映到报表与被动收入。
- `5` `掷骰子`：开始本回合行动。
- `6` `结束回合`：完成本回合后切到下一位玩家。
- `7` 抽卡区：走到“机会格”等会解锁抽卡按钮。
- `8` 合资项目（可选）。
- `9` 游戏日志（可选，但强烈建议经常看/导出复盘）。

---

## 5. 抽卡与决策：买还是跳过

![卡牌弹窗标注](/player-guide/05-card-modal.png)

- `1` 语言切换。
- `2` 棋盘区：你在机会格（Opportunity）时通常需要抽一张投资卡来做决定。
- `3` 卡牌弹窗：展示机会/成本/现金流/描述。
- `4` `购买`：现金足够（或内圈允许银行融资覆盖差额时）可买入，资产与被动收入会更新。
- `5` `跳过`：放弃这次机会。
- `6` 日志记录：你抽到与选择的结果都会被记入日志。

新手建议：
- 第 1 局先关注“现金流”与“被动收入”的变化，优先买能稳定增加现金流的资产。
- 现金紧张时，不要把钱都花光，留出应对“负债/裁员/意外支出”的空间。

---

## 6. 市场响应窗口（Offer / Stock）：可能影响所有玩家

![市场响应窗口标注](/player-guide/06-market-response-window.png)

- `1` 语言切换。
- `2` 棋盘区：走到“市场报价（Market Offer）”等格子会触发市场类卡牌。
- `3` 玩家概览：确认各自现金/资产状况。
- `4` 资产/负债报表：卖出/拆股等结算会体现在这里。
- `5` 市场卡内容区：展示事件说明、规则提示。
- `6` `结算/下一位`（视卡牌而定）：推进市场卡的处理流程。
- `7` `全部跳过`：直接跳过该市场响应流程（若该卡允许）。
- `8` 日志：市场卡每一步也会记录。

提示：
- 有些市场卡带“全员可卖出”提示（Everyone may sell），会允许所有玩家按同一价格卖出符合条件的资产。
- 有些市场卡属于强制事件，会自动结算，无法跳过。

---

## 7. 合资项目（可选）：和其他玩家一起投

![合资项目标注](/player-guide/07-joint-venture-section.png)

- `1` 项目名称：方便复盘与识别。
- `2` 策略/备注 + 资金/现金流：约定投入与预期现金流（用于沙盘演练与记账）。
- `3` 选择参与者：点选参与合资的玩家。
- `4` 参与者补充区：用于扩展/展示（若未来版本增加更多字段）。
- `5` 发起合资：创建合资项目并写入日志。
- `6` 合资列表：显示当前已有合资项目（暂无时显示提示）。

建议玩法：
- 合资前先口头约定：各自出资比例、是否允许退出、如何分配现金流收益。

---

## 8. 玩家借贷（可选）：玩家之间借钱周转

![玩家借贷标注](/player-guide/08-player-loan-section.png)

- `1` 标题区。
- `2` 选择出借人/借款人。
- `3` 本金与年化利率。
- `4` 借贷记录区（创建后会显示记录）。
- `5` 预留展示区（用于扩展/展示）。
- `6` 创建借贷：建立借贷并写入日志。

建议玩法：
- 借贷是“谈判工具”，利率越高对借款人越不利；新手可先用低利率体验流程。

---

## 9. 报表怎么读：资产 / 负债 / 主动清算

![资产负债报表标注](/player-guide/10-balance-sheet-panel.png)

- `1` 报表标题。
- `2` 当前玩家：报表展示的是“当前回合玩家”的资产与负债。
- `3` 资产区：会提示“主动清算”规则（按成本 50% 折价换现金，不按市场价）。
- `4` 负债区：显示各类负债余额与月供。
- `5` 玩家借款：展开可查看玩家间借款（如已创建）。

---

## 10. 游戏日志与复盘：导出 / 导入

![游戏日志标注](/player-guide/11-game-log-panel.png)

- `1` 游戏日志标题。
- `2` `导出日志`：导出 JSON（推荐每局结束导出一次用于复盘/教学）。
- `3` `清空日志`：清空当前局日志。
- `4` 日志卡片：每条日志都有时间、回合与摘要。
- `5` 更多日志卡片：滚动查看历史记录。
- `6` `查看详情`：展开可看到更详细的变更信息（用于对账）。

导入复盘：

![回放导入标注](/player-guide/09-replay-import-section.png)

- `1` 回放/导入入口。
- `2` `导入 JSON`：选择日志 JSON。
- `3` `清除`：清空导入内容，回到普通对局状态。
- `4` 说明：导入后可按日志/回合逐步查看报表变化。

---

## 11. 新手常见问题（FAQ）

### Q1：为什么有些按钮是灰的？
因为当前落点不允许该动作（例如不在机会格时不能抽投资卡）。通常“掷骰子 → 根据落点处理 → 结束回合”即可推进。

### Q2：现金不够还能买/付吗？
内圈（老鼠赛跑）允许银行融资覆盖差额（会生成负债并写日志）；外圈（快车道）禁止银行贷款，现金不足只能放弃/进入清算流程。

### Q3：这局的胜利目标是什么？
内圈目标是让被动收入超过总支出以解锁“进入快车道”；进入快车道后以达成快车道目标为胜利。

